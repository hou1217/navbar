webpackJsonp([1],{"1CMK":function(t,a,e){"use strict";function n(t){e("wIuZ")}var i=e("CIcC"),r=e("C6Mj"),o=e("XyMi"),s=n,c=Object(o.a)(i.a,r.a,r.b,!1,s,null,null);a.a=c.exports},"2NXm":function(t,a,e){"use strict";function n(t){e("hw45")}var i=e("Ued4"),r=e("li3c"),o=e("XyMi"),s=n,c=Object(o.a)(i.a,r.a,r.b,!1,s,null,null);a.a=c.exports},"3f9b":function(t,a){},"7PQ8":function(t,a,e){t.exports=e.p+"static/img/menu-tourist.3730c56.png"},"7UsN":function(t,a,e){t.exports=e.p+"static/img/map-marker-toilet.23ff039.png"},"8CKj":function(t,a,e){"use strict";function n(t){e("zoBF")}var i=e("vpTW"),r=e("piqO"),o=e("XyMi"),s=n,c=Object(o.a)(i.a,r.a,r.b,!1,s,null,null);a.a=c.exports},"9nkg":function(t,a){},"9r66":function(t,a){},C6Mj:function(t,a,e){"use strict";e.d(a,"a",function(){return n}),e.d(a,"b",function(){return i});var n=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"fullpage"},[e("amap",{attrs:{markers:t.markers,center:t.MyLocation.Center,current:t.currentMarker.id},on:{location:t.getLocation,"show-current-marker":t.showCurrentMarkerInfo}}),t._v(" "),e("div",{staticClass:"map-layer map-info-layer"},[e("van-swipe",{ref:"info-swiper",attrs:{"show-indicators":!1},on:{change:t.showCurrentMarker}},t._l(t.markers,function(a,n){return e("van-swipe-item",{key:a.id},[e("div",{staticClass:"spot-info van-hairline--bottom"},[e("h2",{staticClass:"spot-title"},[t._v(t._s(a.title))]),t._v(" "),e("div",{staticClass:"spot-desc"},[a.isNearest?e("span",{staticClass:"spot-label",domProps:{textContent:t._s(a.isNearest?"离我最近":"")}}):t._e()])]),t._v(" "),e("div",{staticClass:"spot-info"},[e("div",{staticClass:"spot-desc"},[t._v(t._s(t._f("fixDistanceText")(a.distance)))]),t._v(" "),e("router-link",{staticClass:"btn spot-navi",attrs:{to:{path:"/navi/"+t.currentMarker.id,query:t.currentMarker}}},[t._v("导航")])],1)])})),t._v(" "),e("span",{directives:[{name:"show",rawName:"v-show",value:t.markers.length,expression:"markers.length"}],staticClass:"spot-indicator"},[t._v(t._s(t.currentIndex+1)+" / "+t._s(t.markers.length))])],1)],1)},i=[]},CCn6:function(t,a,e){"use strict";var n=e("//Fk"),i=e.n(n),r=e("GKy3"),o=(e.n(r),e("4vvA")),s=e.n(o),c=e("mtWM"),u=e.n(c),l=function(t){var a=t.data||{};return{cmd:t.cmd||307,ver:t.ver||"1_4",data:{customerCode:a.customerCode||"lyy",distance:a.distance||50,lng:a.lng,lat:a.lat,pageIndex:a.pageIndex||1,pageSize:a.pageSize||20,type:a.type||"3-4-5-6-7-"}}},d=function(t){var a=t.data||{};return{cmd:t.cmd||103,ver:t.ver||"1_4",data:{spotId:a.spotId,lng:a.lng,lat:a.lat}}},p=u.a.create({baseURL:"http://app.tianxiayunyou.com:9000/why-mobile/mobile/",timeout:1e4});p.interceptors.request.use(function(t){return s.a.loading({duration:0,forbidClick:!0,message:"加载中"}),t},function(t){return s.a.fail("请求失败"),i.a.reject(t)}),p.interceptors.response.use(function(t){return s.a.clear(),t},function(t){return s.a.fail("加载失败"),i.a.reject(t)});var f={GetSpotsList:function(t){return p.post("webservice",l(t))},GetSpotDetail:function(t){return p.post("webservice",d(t))}};a.a=f},CIcC:function(t,a,e){"use strict";var n,i=e("Dd8w"),r=e.n(i),o=e("bOdI"),s=e.n(o),c=e("G/J0"),u=(e.n(c),e("beN6")),l=e.n(u),d=e("08XL"),p=(e.n(d),e("24wo")),f=e.n(p),m=e("NYxO"),h=e("8CKj");a.a={name:"Map",components:(n={Amap:h.a},s()(n,f.a.name,f.a),s()(n,l.a.name,l.a),n),data:function(){return{categoryId:Number(this.$route.params.id),markers:[],currentMarker:{id:0},currentIndex:0,pagination:{pageIndex:1,pageSize:100,pageMax:null}}},computed:r()({},Object(m.c)(["MyLocation","SpotsCategory"])),filters:{fixDistanceText:function(t){if(t=Number(t)){return"距离您约 "+(t>1?Math.round(10*t)/10+" 公里":Math.round(1e3*t)+" 米，加把劲儿就到了哦！")}return""}},beforeRouteUpdate:function(t,a,e){t.params.id!==a.params.id&&(this.categoryId=Number(t.params.id),this.pagination.pageIndex=1,this.pagination.pageMax=null,this.markers=[],this.getCategoryTitle(),this.fetchData()),e()},created:function(){this.getCategoryTitle()},methods:r()({},Object(m.b)(["REQUEST_API"]),{fetchData:function(){var t=this;this.MyLocation.Lng&&this.MyLocation.Lat&&this.REQUEST_API({api:"GetSpotsList",cache:{key:"list_"+this.categoryId+"__p_"+this.pagination.pageIndex},data:r()({type:this.categoryId+"-",lng:this.MyLocation.Lng,lat:this.MyLocation.Lat},this.pagination)}).then(function(a){0===a.code&&a.data&&a.data instanceof Array&&(t.markers=a.data,0===a.data.length?t.pagination.pageMax=t.pagination.pageIndex:t.pagination.pageIndex++,setTimeout(function(){var a=t.nearestSpot();t.showCurrentMarker(a.marker),t.showCurrentMarkerInfo(a.marker,a.index)}))})},getLocation:function(t){0===this.markers.length&&this.fetchData()},showCurrentMarker:function(t){t="number"==typeof t?this.markers[t]:t,this.currentMarker=t,this.$store.dispatch("SET_MAP_CENTER",t)},showCurrentMarkerInfo:function(t,a){void 0===a&&(a=0,this.markers.forEach(function(e,n){e.id===t.id&&(a=n)})),this.currentIndex=a,this.$refs["info-swiper"].swipeTo(a)},nearestSpot:function(){var t={index:0,marker:{}};return this.markers.forEach(function(a,e){a.distance&&(a.distance<t.marker.distance||!t.marker.distance)&&(t.index=e,t.marker=a)}),this.$set(this.markers[t.index],"isNearest",!0),t},getCategoryTitle:function(){var t=this,a=this.SpotsCategory.filter(function(a){return a.id===t.categoryId})[0];a&&this.$store.commit("SET_PAGE_TITLE",a.name)}})}},DmDV:function(t,a,e){"use strict";e.d(a,"a",function(){return n}),e.d(a,"b",function(){return i});var n=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"fullpage"},[e("amap",{attrs:{markers:t.markers,center:t.MyLocation.Center,"no-detail":t.noDetail},on:{location:t.getLocation,"navi-solution":t.showNaviStep}}),t._v(" "),e("div",{staticClass:"map-layer map-route-layer",class:{extend:t.extendRouteList}},[t.currentMarker.id?e("div",{ref:"spot-info",staticClass:"spot-info van-hairline--bottom",on:{click:function(a){t.extendRouteList=!t.extendRouteList}}},[e("h2",{staticClass:"spot-title"},[t._v(t._s(t.currentMarker.title))]),t._v(" "),e("div",{staticClass:"spot-desc"},[t._v(t._s(t._f("fixDistanceText")(t.currentMarker.distance)))]),t._v(" "),e("button",{staticClass:"btn spot-navi",domProps:{textContent:t._s(t.extendRouteList?"收起":"跟我走")}})]):t._e(),t._v(" "),t.routes[0]?e("div",{staticClass:"route-steps-list",style:{top:t.infoHeight}},t._l(t.routes[0].steps,function(a,n){return e("div",{key:n,staticClass:"route-step"},[e("i",{staticClass:"icon",class:0===n?"icon-start":n===t.routes[0].steps.length-1?"icon-end":"icon-"+t.routeStepIcon[a.action]}),t._v(" "),e("p",{staticClass:"description"},[t._v(t._s(a.instruction))]),t._v(" "),e("span",{staticClass:"label"},[t._v(t._s(a.action+" "+a.assistant_action))])])})):t._e()])],1)},i=[]},DvuN:function(t,a,e){t.exports=e.p+"static/img/menu-restaurant.084d041.png"},Hheg:function(t,a,e){"use strict";e.d(a,"a",function(){return n}),e.d(a,"b",function(){return i});var n=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{attrs:{id:"app"}},[e("router-view")],1)},i=[]},IcnI:function(t,a,e){"use strict";var n=e("7+uW"),i=e("NYxO"),r=e("mUbh"),o=e("ukYY"),s=e("qLWY");n.default.use(i.a),a.a=new i.a.Store({state:{UA:s.a,AppName:"智能导览",PageTitle:"智能导览",MyLocation:{Lng:0,Lat:0,Center:[121.466019,31.230231]},SpotsCategory:[{id:2,name:"景点",icon:e("7PQ8"),markerIcon:e("R6sw"),route:"/list/2",type:"spot"},{id:3,name:"美食",icon:e("DvuN"),markerIcon:e("rSB9"),route:"/list/3",type:"restaurant"},{id:6,name:"厕所",icon:e("wsH6"),markerIcon:e("7UsN"),route:"/map/6",type:"toilet"},{id:4,name:"酒店",icon:e("lUrR"),markerIcon:e("g7k/"),route:"/list/4",type:"hotel"}],MapInstance:null,GeolocationInstance:null,LocatingPosition:!1,LoadingData:!1,CacheData:{}},actions:r.a,mutations:o.a})},KCBl:function(t,a){},M93x:function(t,a,e){"use strict";function n(t){e("yAHZ")}var i=e("xJD8"),r=e("Hheg"),o=e("XyMi"),s=n,c=Object(o.a)(i.a,r.a,r.b,!1,s,null,null);a.a=c.exports},MARM:function(t,a,e){"use strict";e.d(a,"a",function(){return n}),e.d(a,"b",function(){return i});var n=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[e("div",{staticClass:"list-card"},t._l(t.list,function(a){return e("router-link",{key:a.id,attrs:{to:"/detail/"+a.id}},[e("van-card",{staticClass:"van-hairline--bottom",attrs:{title:a.title,thumb:t._f("fixSpotImage")(a.firstpic||a.smallpic)}},[e("div",{staticClass:"van-card__desc",attrs:{slot:"desc"},slot:"desc"},[e("p",{staticClass:"distance"},[t._v("距您 "+t._s(t._f("fixDistance")(a.distance))+" KM")]),t._v(" "),e("p",{staticClass:"address"},[t._v(t._s(a.address))])]),t._v(" "),e("div",{staticClass:"buttons",attrs:{slot:"footer"},slot:"footer"},["spot"===t.categoryInfo.type?e("a",{staticClass:"btn btn-detail"},[t._v("详情")]):t._e(),t._v(" "),"restaurant"!==t.categoryInfo.type&&"hotel"!==t.categoryInfo.type?e("router-link",{staticClass:"btn btn-navi",attrs:{to:{path:"/navi/"+a.id,query:a}}},[t._v("导航")]):t._e(),t._v(" "),"restaurant"===t.categoryInfo.type?e("span",{staticClass:"price"},[e("em",[t._v(t._s(t._f("fixPrice")(a.price)))]),t._v(" /人")]):t._e(),t._v(" "),"hotel"===t.categoryInfo.type?e("span",{staticClass:"price"},[e("em",[t._v(t._s(t._f("fixPrice")(a.price)))])]):t._e()],1)])],1)})),t._v(" "),e("mugen-scroll",{attrs:{handler:t.fetchData,"should-handle":!t.LoadingData}},[e("van-loading",{directives:[{name:"show",rawName:"v-show",value:t.hasMoreData,expression:"hasMoreData"}],attrs:{color:"black"}})],1)],1)},i=[]},NHnr:function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var n=e("7+uW"),i=e("/IwO"),r=e.n(i),o=e("YaEn"),s=e("IcnI"),c=e("M93x");n.default.use(r.a),r.a.initAMapApiLoader({key:"dfd0d93b3bc6bb2607ef3b76a4eb751c",plugin:["Scale","OverView","ToolBar","Geolocation","Driving","Transfer","Walking"],uiVersion:"1.0",v:"1.4.8"}),new n.default({el:"#app",router:o.a,store:s.a,render:function(t){return t(c.a)}})},"O/ao":function(t,a,e){"use strict";var n,i=e("Xxa5"),r=e.n(i),o=e("GKy3"),s=(e.n(o),e("4vvA")),c=e.n(s),u=e("exGp"),l=e.n(u),d=e("Dd8w"),p=e.n(d),f=e("bOdI"),m=e.n(f),h=e("G/J0"),v=(e.n(h),e("beN6")),g=e.n(v),_=e("08XL"),y=(e.n(_),e("24wo")),I=e.n(y),C=e("QP/A"),M=(e.n(C),e("pyxX")),x=e.n(M),L=e("cnGM"),k=(e.n(L),e("S6j6")),b=e.n(k),A=e("NYxO"),T=e("qLWY"),w=e("fPUB");a.a={name:"Detail",components:(n={},m()(n,b.a.name,b.a),m()(n,x.a.name,x.a),m()(n,I.a.name,I.a),m()(n,g.a.name,g.a),n),filters:{fixSpotImage:T.b,fixDistance:function(t){return parseFloat(t).toFixed(1).toString()},fixPrice:function(t){try{t=parseFloat(t.replace("￥","").replace("/人",""))}catch(a){t=0}return t||0}},data:function(){return{id:Number(this.$route.params.id),detail:{}}},computed:p()({categoryInfo:function(){var t=this,a=this.SpotsCategory.filter(function(a){return a.id===t.detail.categoryId})[0];return a&&this.$store.commit("SET_PAGE_TITLE",a.name),a||{id:this.categoryId,name:"未知"}}},Object(A.c)(["LoadingData","LocatingPosition","MyLocation","SpotsCategory"])),created:function(){this.fetchData()},beforeRouteUpdate:function(t,a,e){t.params.id!==a.params.id&&(this.id=Number(t.params.id),this.detail={},this.fetchData()),e()},methods:p()({},Object(A.b)(["REQUEST_API","GET_LOCATION"]),{fetchData:function(){var t=this;return l()(r.a.mark(function a(){return r.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t.GET_LOCATION();case 2:t.REQUEST_API({api:"GetSpotDetail",data:{spotId:""+t.id,lng:t.MyLocation.Lng,lat:t.MyLocation.Lat}}).then(function(a){if(0===a.code&&a.data){var e=a.data instanceof Array?a.data[0]:a.data;e||(e=w.a.SpotDetail,setTimeout(function(){c.a.fail("没有地点详情")},500));var n=e.firstpic||e.smallpic;n=n instanceof Array?n:[n],t.detail={categoryId:e.type,images:n,title:e.title,description:e.timedesc,label:e.label||e.ssd,address:e.address,contact:e.contact,price:e.price||e.ticket,distance:e.distance,content:e.description}}});case 3:case"end":return a.stop()}},a,t)}))()}})}},PipD:function(t,a,e){"use strict";var n,i=e("Xxa5"),r=e.n(i),o=e("exGp"),s=e.n(o),c=e("Dd8w"),u=e.n(c),l=e("bOdI"),d=e.n(l),p=e("uTM9"),f=(e.n(p),e("Jq84")),m=e.n(f),h=e("1r3O"),v=(e.n(h),e("mKRw")),g=e.n(v),_=e("NYxO"),y=e("EbDR"),I=e.n(y),C=e("qLWY");a.a={name:"List",components:(n={MugenScroll:I.a},d()(n,g.a.name,g.a),d()(n,m.a.name,m.a),n),filters:{fixSpotImage:C.b,fixDistance:function(t){return parseFloat(t).toFixed(1).toString()},fixPrice:function(t){try{t=parseFloat(t.replace("￥","").replace("/人",""))}catch(a){t=0}return t||0}},data:function(){return{categoryId:Number(this.$route.params.id),list:[],pagination:{pageIndex:1,pageSize:20,pageMax:null}}},computed:u()({categoryInfo:function(){var t=this,a=this.SpotsCategory.filter(function(a){return a.id===t.categoryId})[0];return a&&this.$store.commit("SET_PAGE_TITLE",a.name),a||{id:this.categoryId,name:"未知"}},hasMoreData:function(){return this.pagination.pageMax>this.pagination.pageIndex||!this.pagination.pageMax}},Object(_.c)(["LoadingData","MyLocation","SpotsCategory"])),created:function(){},beforeRouteUpdate:function(t,a,e){t.params.id!==a.params.id&&(this.categoryId=Number(t.params.id),this.pagination.pageIndex=1,this.pagination.pageMax=null,this.list=[],this.fetchData()),e()},methods:u()({},Object(_.b)(["REQUEST_API","GET_LOCATION"]),{fetchData:function(){var t=this;return s()(r.a.mark(function a(){return r.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!t.hasMoreData){a.next=4;break}return a.next=3,t.GET_LOCATION();case 3:t.REQUEST_API({api:"GetSpotsList",cache:{key:"list_"+t.categoryId+"__p_"+t.pagination.pageIndex},data:u()({type:t.categoryId+"-",lng:t.MyLocation.Lng,lat:t.MyLocation.Lat},t.pagination)}).then(function(a){0===a.code&&a.data&&a.data instanceof Array&&(t.list=t.list.concat(a.data),0===a.data.length?t.pagination.pageMax=t.pagination.pageIndex:t.pagination.pageIndex++)});case 4:case"end":return a.stop()}},a,t)}))()}})}},R6sw:function(t,a,e){t.exports=e.p+"static/img/map-marker-tourist.dd8f089.png"},Ued4:function(t,a,e){"use strict";var n,i=e("Dd8w"),r=e.n(i),o=e("bOdI"),s=e.n(o),c=e("eoO4"),u=(e.n(c),e("O++1")),l=e.n(u),d=e("SsyO"),p=(e.n(d),e("4jjj")),f=e.n(p),m=e("NYxO"),h=e("8CKj");a.a={name:"Home",components:(n={Amap:h.a},s()(n,f.a.name,f.a),s()(n,l.a.name,l.a),n),data:function(){return{markers:[]}},computed:r()({},Object(m.c)(["MyLocation","SpotsCategory"])),created:function(){this.$store.commit("SET_PAGE_TITLE","DEFAULT")},methods:r()({},Object(m.b)(["REQUEST_API"]),{fetchData:function(){var t=this;this.REQUEST_API({api:"GetSpotsList",cache:{key:"list_home_all"},data:{lng:this.MyLocation.Lng,lat:this.MyLocation.Lat}}).then(function(a){0===a.code&&a.data&&a.data instanceof Array&&(t.loaded=!0,t.markers=a.data,setTimeout(function(){t.$store.dispatch("SET_MAP_CENTER",t.markers[0])}))})},getLocation:function(t){0===this.markers.length&&this.fetchData()}})}},Uel7:function(t,a,e){"use strict";function n(t){e("KCBl")}var i=e("f7Dd"),r=e("DmDV"),o=e("XyMi"),s=n,c=Object(o.a)(i.a,r.a,r.b,!1,s,null,null);a.a=c.exports},VlgL:function(t,a,e){"use strict";function n(t){e("qhxy")}var i=e("PipD"),r=e("MARM"),o=e("XyMi"),s=n,c=Object(o.a)(i.a,r.a,r.b,!1,s,null,null);a.a=c.exports},YaEn:function(t,a,e){"use strict";var n=e("7+uW"),i=e("/ocq"),r=e("2NXm"),o=e("VlgL"),s=e("f2Us"),c=e("1CMK"),u=e("Uel7");n.default.directive("page-title",{inserted:function(t,a){document.title=a.value},update:function(t,a){document.title=a.value}}),n.default.use(i.a);var l=new i.a({routes:[{name:"Home",path:"/",component:r.a,meta:{title:"智能导览"}},{name:"List",path:"/list/:id",component:o.a,meta:{title:"地点列表"}},{name:"Detail",path:"/detail/:id",component:s.a,meta:{title:"地点详情"}},{name:"Map",path:"/map/:id",component:c.a,meta:{title:"地点地图"}},{name:"Navi",path:"/navi/:id",component:u.a,meta:{title:"导航路线"}}],scrollBehavior:function(t,a,e){return e||{x:0,y:0}}});l.beforeEach(function(t,a,e){t.matched[0].meta.title&&(document.title=t.matched[0].meta.title),e()}),a.a=l},dCOM:function(t,a){},f2Us:function(t,a,e){"use strict";function n(t){e("w0Jy")}var i=e("O/ao"),r=e("pt2K"),o=e("XyMi"),s=n,c=Object(o.a)(i.a,r.a,r.b,!1,s,null,null);a.a=c.exports},f7Dd:function(t,a,e){"use strict";var n=e("GKy3"),i=(e.n(n),e("4vvA")),r=e.n(i),o=e("Dd8w"),s=e.n(o),c=e("NYxO"),u=e("8CKj");a.a={name:"Navi",components:{Amap:u.a},data:function(){return{id:Number(this.$route.params.id),markers:[],currentMarker:{},routes:[],extendRouteList:!1,routeStepIcon:{"直行":"straight","左转":"turn-left","右转":"turn-right","靠左":"left","靠右":"right"},noDetail:0,infoHeight:"100%"}},computed:s()({},Object(c.c)(["MyLocation","SpotsCategory"])),filters:{fixDistanceText:function(t){if(t=Number(t)){return"距离您约 "+(t>1?Math.round(10*t)/10+" 公里":Math.round(1e3*t)+" 米，加把劲儿就到了哦！")}return""}},beforeRouteUpdate:function(t,a,e){t.params.id!==a.params.id&&(this.id=Number(t.params.id),this.markers=[],this.routes=[],this.fetchData()),e()},methods:s()({},Object(c.b)(["REQUEST_API"]),{fetchData:function(){var t=this;this.MyLocation.Lng&&this.MyLocation.Lat&&this.REQUEST_API({api:"GetSpotDetail",data:{spotId:""+this.id,lng:this.MyLocation.Lng,lat:this.MyLocation.Lat}}).then(function(a){if(0===a.code&&a.data){var e=a.data instanceof Array?a.data[0]:a.data;e?(t.markers.push(e),setTimeout(function(){t.$store.dispatch("SET_MAP_CENTER",e)})):(t.noDetail=t.id,t.renderDataByQuery())}})},renderDataByQuery:function(){var t=this,a=this.$route.query;if(a.lng&&a.lat){var e={id:Number(a.id),title:a.title||"未知地点",address:a.address||"",lng:a.lng,lat:a.lat,distance:a.distance||0,firstpic:a.image||null};this.markers.push(e),setTimeout(function(){t.$store.dispatch("SET_MAP_CENTER",e)})}else r.a.fail("未知地点")},getLocation:function(t){0===this.markers.length&&this.fetchData()},showNaviStep:function(t,a){var e=this;this.currentMarker=t,this.routes=a,this.$nextTick(function(){e.infoHeight=e.$refs["spot-info"].offsetHeight+"px"})}})}},fPUB:function(t,a,e){"use strict";a.a={SpotDetail:{type:3,firstpic:["http://qcloud.dpfile.com/pc/Ce8bxXQvQPBtoi5Xo4PRhCeJH_oC1ZiWlIKIVSs3Ci1sH4dqfm3KQ5aXyB6q_6zzjoJrvItByyS4HHaWdXyO_DrXIaWutJls2xCVbatkhjUNNiIYVnHvzugZCuBITtvjski7YaLlHpkrQUr5euoQrg.jpg","http://qcloud.dpfile.com/pc/7MEbW2cF7VT-KTtanWxdxv8Ro82pKTBAQLQjdDAyVhrMyPRMleaDSP-6WmQuJiv6joJrvItByyS4HHaWdXyO_DrXIaWutJls2xCVbatkhjUNNiIYVnHvzugZCuBITtvjski7YaLlHpkrQUr5euoQrg.jpg","http://qcloud.dpfile.com/pc/rZGUnR9iaLSSbe0J5mNlhFyYyOAUm4zJWG4rvPGLP6LMyPRMleaDSP-6WmQuJiv6joJrvItByyS4HHaWdXyO_DrXIaWutJls2xCVbatkhjUNNiIYVnHvzugZCuBITtvjski7YaLlHpkrQUr5euoQrg.jpg"],title:"未知地点（示例页）",timedesc:"沪上首座环形草坪露天音乐剧场",ssd:"4A国家级旅游景区",address:"申迪南路177号星愿公园内",contact:"021-88008800",ticket:"300",distance:31.5,description:"\n      <p>沪上资深乐迷都知道，听歌剧要去上海大剧院，听音乐剧就去文化广场，听交响乐是上交音乐厅表现最好。如果想去户外赏乐呢？随着Maxus大通音乐谷投入使用，市民欣赏高品质音乐又有好去处。和一般使用临时场地的户外音乐演出不同，音乐谷是一处专门为各类文艺演出打造的常设性、高配置的专业音乐场地。</p>\n      <p>Maxus大通音乐谷毗邻上海迪士尼乐园，是沪上首座环形草坪露天音乐剧场，剧场面积近4万平方米。音乐谷以舞台为中心，向外划出两个同心圆，像一只绿孔雀在星愿湖旁开屏展翅。据上海申迪（集团）有限公司副总裁王庆国介绍，Maxus大通音乐谷的设计理念来源于古希腊、古罗马的露天剧场意象。音乐谷采用了下沉式、圆弧形的广场构造，实现了户外剧场良好的聚音效果。看台与舞台之间是绿草如茵的小广场，体现音乐与自然亲近的理念。此外，中央舞台上方搭盖的防雨顶棚，保证演出不受上海多变天气的影响。</p>\n      <p>为保证户外音乐会的高品质音质，音乐谷特邀沙晓岚领衔的舞美团队，倾力打造演出声效。该团队曾参与G20峰会、“一带一路”国际高峰论坛文艺晚会。据介绍，团队凭借高科技舞台工程设计，运用专业灯光音响系统，使得包括交响乐在内的各类演出音响，达到足够的声压及层次感。沙晓岚表示，剧场完全可以“兼顾经典与流行”。</p>\n      <p>自去年建成后，Maxus大通音乐谷得到了众多业内人士的好评和青睐。去年5月，世界著名的费城交响乐团在音乐谷为上海国际旅游度假区开放献演。演出结束后，乐团对音乐谷的户外表现力赞誉有加，提前一年定下2017度假区音乐之约，将于5月27日晚上演。</p>\n    "}}},"g7k/":function(t,a,e){t.exports=e.p+"static/img/map-marker-hotel.7830264.png"},hw45:function(t,a){},itIU:function(t,a){},lUrR:function(t,a,e){t.exports=e.p+"static/img/menu-hotel.c0e88a8.png"},li3c:function(t,a,e){"use strict";e.d(a,"a",function(){return n}),e.d(a,"b",function(){return i});var n=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"fullpage"},[e("amap",{attrs:{markers:t.markers,center:t.MyLocation.Center},on:{location:t.getLocation}}),t._v(" "),e("div",{staticClass:"toolbar"},[t.MyLocation.Lng&&t.MyLocation.Lat?e("span",[t._v("\n      location: lng = "+t._s(t.MyLocation.Lng)+" lat = "+t._s(t.MyLocation.Lat)+"\n    ")]):e("span",[t._v("正在定位")])]),t._v(" "),e("div",{staticClass:"menu-bar"},[e("van-tabbar",t._l(t.SpotsCategory,function(a){return e("van-tabbar-item",{key:a.id,staticClass:"menu-item",attrs:{to:a.route}},[e("img",{attrs:{slot:"icon",src:a.icon},slot:"icon"}),t._v(" "),e("span",[t._v(t._s(a.name))])])}))],1)],1)},i=[]},mUbh:function(t,a,e){"use strict";var n=e("+6Bu"),i=e.n(n),r=e("mvHQ"),o=e.n(r),s=e("GKy3"),c=(e.n(s),e("4vvA")),u=e.n(c),l=e("//Fk"),d=e.n(l),p=e("Xxa5"),f=e.n(p),m=e("exGp"),h=e.n(m),v=e("/IwO"),g=(e.n(v),e("CCn6"));a.a={INIT_MAP:function(t){var a=this,e=t.commit,n=t.state;return h()(f.a.mark(function t(){return f.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n.MapInstance){t.next=5;break}return t.next=3,v.lazyAMapApiLoaderInstance.load();case 3:n.MapInstance=new AMap.Map("_"),e("SET_MAP_INSTANCE",n.MapInstance);case 5:return t.abrupt("return",n.MapInstance);case 6:case"end":return t.stop()}},t,a)}))()},GET_LOCATION:function(t){var a=this,e=t.commit,n=t.dispatch,i=t.state;return h()(f.a.mark(function t(){var r;return f.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(i.GeolocationInstance){t.next=5;break}return t.next=3,v.lazyAMapApiLoaderInstance.load();case 3:i.GeolocationInstance=new AMap.Geolocation({timeout:1e4,maximumAge:1e4}),e("SET_GEOLOCATION_INSTANCE",i.GeolocationInstance);case 5:return r=new d.a(function(t,a){var r=!1;if(i.MyLocation.Lng&&i.MyLocation.Lat)return void t({lng:i.MyLocation.Lng,lat:i.MyLocation.Lat});var s={};try{s=JSON.parse(sessionStorage.getItem("my_location"))||{}}catch(t){}s.lng&&s.lat?(n("SET_LOCATION",s),t(s),r=!0):u.a.loading({duration:0,forbidClick:!0,message:"定位中"}),e("LOCATING_POSITION",!0),i.GeolocationInstance.getCurrentPosition(function(a,i){if(u.a.clear(),e("LOCATING_POSITION",!1),"complete"===a){try{sessionStorage.setItem("my_location",o()(i.position))}catch(t){}n("SET_LOCATION",i.position),!r&&t(i.position)}else n("SET_LOCATION"),!r&&t(i)})}),t.abrupt("return",r);case 7:case"end":return t.stop()}},t,a)}))()},SET_LOCATION:function(t,a){var e=t.commit,n=(t.dispatch,t.state);a=a||{lng:n.MyLocation.Center[0],lat:n.MyLocation.Center[1]},e("SET_STATE",{target:"MyLocation",child:"Lng",data:a.lng}),e("SET_STATE",{target:"MyLocation",child:"Lat",data:a.lat})},SET_MAP_CENTER:function(t,a){var e=t.commit;a&&(a=a instanceof Array?{lng:a[0],lat:a[1]}:a,e("SET_STATE",{target:"MyLocation",child:"Center",data:[parseFloat(a.lng),parseFloat(a.lat)]}))},REQUEST_API:function(t,a){var e=this,n=t.commit,r=t.state,o=a.api,s=a.cache,c=i()(a,["api","cache"]);return h()(f.a.mark(function t(){var a,i;return f.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a={code:-1,msg:"未定义接口",data:null},n("LOADING_DATA",!0),i=null,!g.a[o]){t.next=21;break}if(!s){t.next=16;break}if(!r.CacheData[s.key]){t.next=10;break}i=r.CacheData[s.key],t.next=14;break;case 10:return t.next=12,g.a[o](c);case 12:i=t.sent.data,r.CacheData[s.key]=i;case 14:t.next=19;break;case 16:return t.next=18,g.a[o](c);case 18:i=t.sent.data;case 19:t.next=22;break;case 21:i=a;case 22:return n("LOADING_DATA",!1),t.abrupt("return",i);case 24:case"end":return t.stop()}},t,e)}))()}}},piqO:function(t,a,e){"use strict";e.d(a,"a",function(){return n}),e.d(a,"b",function(){return i});var n=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("el-amap",{staticClass:"amap-box",attrs:{vid:"amap-box",zoom:12,center:t.mapCenter,plugin:t.plugin,events:t.events,"amap-manager":t.amapManager}},[t._l(t.normalizedMarkers,function(a){return e("el-amap-marker",{key:a.id,attrs:{vid:a.id,position:a.position,data:a,offset:[-23,-58],zIndex:t.markersZIndex[a.id]||100,icon:t.getMarkerIcon(a.category),events:t.markerEvents}})}),t._v(" "),e("el-amap-info-window",{attrs:{isCustom:!0,autoMove:!0,offset:[0,-60],position:t.infoWindow.position,template:t.infoWindow.template,visible:t.infoWindow.visible,events:t.infoWindow.events}},[e("div",{staticClass:"info-window"},[e("div",{staticClass:"info-head"},[t.isNavi?t._e():e("a",{staticClass:"navi",attrs:{href:t.infoWindow.naviLink}},[t._v("导航")]),t._v(" "),e("a",{attrs:{href:t.infoWindow.link}},[e("p",{staticClass:"title"},[t._v(t._s(t.infoWindow.data.title))])])]),t._v(" "),e("a",{attrs:{href:t.infoWindow.link}},[e("div",{staticClass:"info-body"},[e("img",{attrs:{src:t.infoWindow.data.image}}),t._v(" "),e("p",{staticClass:"distance"},[t._v(t._s(t._f("fixDistanceText")(t.infoWindow.data.distance)))]),t._v(" "),e("p",{staticClass:"address"},[t._v(t._s(t.infoWindow.data.address))])])])])])],2)},i=[]},pt2K:function(t,a,e){"use strict";e.d(a,"a",function(){return n}),e.d(a,"b",function(){return i});var n=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[e("van-swipe",{attrs:{autoplay:3e3}},t._l(t.detail.images,function(t,a){return e("van-swipe-item",{key:a},[e("img",{attrs:{src:t}})])})),t._v(" "),e("van-cell-group",[e("van-cell",{staticClass:"detail-cell-title",attrs:{title:t.detail.title,label:t.detail.description||""}},[[t.detail.label?e("div",{staticClass:"detail-label"},[t._v(t._s(t.detail.label))]):t._e()],t._v(" "),t.detail.price?["restaurant"===t.categoryInfo.type?e("span",{staticClass:"detail-price"},[e("em",[t._v(t._s(t._f("fixPrice")(t.detail.price)))]),t._v(" /人")]):e("span",{staticClass:"detail-price"},[e("em",[t._v(t._s(t._f("fixPrice")(t.detail.price)))])])]:t._e()],2),t._v(" "),t.detail.address?e("van-cell",{attrs:{title:t.detail.address,label:t.detail.distance?"距您 "+t.detail.distance+" KM":"","is-link":"",to:{path:"/navi/"+t.id,query:t.detail}}},[e("template",{slot:"icon"},[e("span",{staticClass:"cell-img-icon cell-icon-location"})])],2):t._e(),t._v(" "),t.detail.contact?e("van-cell",{attrs:{title:t.detail.contact,"is-link":"",url:"tel:"+t.detail.contact}},[e("template",{slot:"icon"},[e("span",{staticClass:"cell-img-icon cell-icon-contact"})])],2):t._e()],1),t._v(" "),t.detail.content?e("van-cell-group",[e("van-cell",[[e("div",{staticClass:"van-cell-text",domProps:{innerHTML:t._s(t.detail.content)}})]],2)],1):t._e()],1)},i=[]},qLWY:function(t,a,e){"use strict";e.d(a,"a",function(){return i}),e.d(a,"b",function(){return r});var n=function(t){return t.test(window.navigator.userAgent.toLowerCase())},i={iphone:n(/iphone/),ipad:n(/ipad/),android:n(/android/),weixin:n(/micromessenger/)},r=function(t){return t||"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAQAAAAnOwc2AAAAEUlEQVR42mN8958BAzAOZUEAmNwTTeAV+t4AAAAASUVORK5CYII="}},qhxy:function(t,a){},rSB9:function(t,a,e){t.exports=e.p+"static/img/map-marker-restaurant.a6ca605.png"},ukYY:function(t,a,e){"use strict";var n=e("7+uW");a.a={SET_STATE:function(t,a){var e=a.target,i=a.child,r=a.data;if(i){var o=t;e.split(".").forEach(function(t){o=o[t]}),o.hasOwnProperty(i)?o[i]=r:n.default.set(o,i,r)}else t[e]=r},SET_PAGE_TITLE:function(t,a){a&&(t.PageTitle="DEFAULT"===a?t.AppName:a,document.title=t.PageTitle)},LOADING_DATA:function(t,a){t.LoadingData=!!a},LOCATING_POSITION:function(t,a){t.LocatingPosition=!!a},SET_MAP_INSTANCE:function(t,a){t.MapInstance=a},SET_GEOLOCATION_INSTANCE:function(t,a){t.GeolocationInstance=a}}},vpTW:function(t,a,e){"use strict";var n=e("fZjL"),i=e.n(n),r=e("/IwO"),o=(e.n(r),e("qLWY")),s=new r.AMapManager;a.a={props:{center:{type:Array},markers:{type:Array,default:[]},current:{type:Number,default:0},noDetail:{type:Number,default:0}},computed:{normalizedMarkers:function(){var t=this,a={};if(this.markers.forEach(function(e){a[e.id]={id:e.id,category:Number(e.category),position:[parseFloat(e.lng),parseFloat(e.lat)],distance:parseFloat(e.distance),title:e.title,address:e.address,image:Object(o.b)(e.firstpic||e.smallpic),zIndex:t.markerZIndex,icon:t.$store.state.SpotsCategory}}),1===this.markers.length){var e=a[this.markers[0].id];this.showInfoWindow(e),this.isNavi&&e&&this.searchRoute({lng:e.position[0],lat:e.position[1]})}return a},mapCenter:function(){return this.center}},filters:{fixDistanceText:function(t){if(t=Number(t)){return"距您 "+(t>1?Math.round(10*t)/10+" 公里":Math.round(1e3*t)+" 米")}return""}},data:function(){var t=this;return{isNavi:!1,loaded:!1,amapManager:s,infoWindow:{position:[0,0],template:"",events:{},visible:!1,data:{}},myLocation:{},markersZIndex:{},maxZIndex:100,currentMarker:{},markerEvents:{click:function(a){var e=t.normalizedMarkers[a.target.F.vid];t.showInfoWindow(e)}},events:{init:function(a){window.MapInstance=a,t.$store.commit("SET_MAP_INSTANCE",a),t.$store.dispatch("GET_LOCATION").then(function(a){t.$emit("location",a)})}},plugin:[{pName:"ToolBar",position:"RT",liteStyle:!0},{pName:"Geolocation",buttonPosition:"RT",events:{complete:function(a){a.position&&(t.myLocation=a.position,t.$store.dispatch("SET_LOCATION",a.position),t.$store.dispatch("SET_MAP_CENTER",a.position))},error:function(){t.$store.dispatch("SET_LOCATION").then(function(){t.$emit("location")})}}}]}},created:function(){this.isNavi="Navi"===this.$route.name},methods:{getMarkerIcon:function(t){var a=this.$store.state.SpotsCategory.filter(function(a){return a.id===t})[0];return a=a||this.$store.state.SpotsCategory[0],a.markerIcon},showInfoWindow:function(t){if(t){t.distance=parseFloat(t.distance)?parseFloat(t.distance).toFixed(1).toString():null,this.infoWindow.data=t,this.infoWindow.position=t.position,this.infoWindow.visible=!0,this.infoWindow.link=t.id===this.noDetail?"javascript:;":"#/detail/"+t.id,this.infoWindow.naviLink="#/navi/"+t.id+"?";var a=this.markers.filter(function(a){return a.id===t.id})[0];this.infoWindow.naviLink+=i()(a).map(function(t){return t+"="+a[t]}).join("&"),this.maxZIndex++,this.$set(this.markersZIndex,t.id,this.maxZIndex),this.$emit("show-current-marker",t)}},searchRoute:function(t,a){var e=this;a=a||this.$store.state.MyLocation;var n=s.getMap();if(AMap){var i=new AMap.Driving({map:n,policy:AMap.DrivingPolicy.LEAST_TIME}),r=new AMap.Walking({map:n}),o=new AMap.LngLat(a.lng||a.Lng,a.lat||a.Lat),c=new AMap.LngLat(t.lng,t.lat),u=Math.round(o.distance(c));this.infoWindow.data.distance=this.infoWindow.data.distance||u/1e3;(u>1e3?i:r).search(o,c,function(t,a){e.$emit("navi-solution",e.infoWindow.data,a.routes)})}}},watch:{current:function(t,a){if(t!==a){var e=this.normalizedMarkers[t];this.showInfoWindow(e)}}}}},w0Jy:function(t,a){},wIuZ:function(t,a){},wsH6:function(t,a,e){t.exports=e.p+"static/img/menu-toilet.80398be.png"},xJD8:function(t,a,e){"use strict";a.a={name:"app"}},xL5C:function(t,a){},yAHZ:function(t,a){},zoBF:function(t,a){}},["NHnr"]);
//# sourceMappingURL=app.d4c850ef3c3eb6bee5d3.js.map